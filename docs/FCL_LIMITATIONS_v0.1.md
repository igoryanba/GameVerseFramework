# FiveM Compatibility Layer – Ограничения версии v0.1 (MVP)

> ⚠️ Этот документ фиксирует текущие пределы и известные проблемы слоя совместимости (FCL) на момент внутреннего **alpha-релиза**.

## Поддерживаемые возможности

1. **Ключевые Native-функции (24 шт.)**
   – Категории `PLAYER`, `VEHICLE`, `PED`  
   – Полный список: см. `core/src/fcl/mod.rs::TOP_NATIVE_NAMES` + дополнительные в последнем коммите.
2. **Событийная шина**  
   – `RegisterNetEvent`, `TriggerEvent`, `TriggerServerEvent` реализованы через встроенную систему событий GameVerse (ограничено, см. ниже).
3. **Конвертация `fxmanifest.lua` → `gameverse.toml`**  
   – Поддерживаются ключевые поля (`fx_version`, `game`, `lua54`, *_scripts).
4. **Горячая перезагрузка** плагинов, зарегистрированных через FCL-бридж.

## Ограничения

| Область | Ограничение v0.1 | План решения |
|---------|------------------|--------------|
| **Нативы** | Только 24 топ-функции. Отсутствуют продвинутые нативы (GRAPHICS, NETWORK). | Расширить до 200+ в v0.2, далее полный охват через `native-generator`.
| **Аргументы функций** | Примитивные типы `int`, `float`, `bool`. Строки и массивы – WIP. | После завершения `NativeType::Array` и строки в генераторе.
| **EventBridge** | Однопоточная доставка, нет приоритезации. | Перейти на канал `tokio::broadcast` + приоритетные очереди.
| **Транспилер** | Не поддерживает `ui_page`, `files`, `data_file` секции. Игнорирует условные директивы. | Парсер Lua (`mlua`) + детальная TOML-схема в v0.2.
| **Resource Lifecycle** | Нет автоматической установки зависимостей (`oxmysql`, `ox_lib`). | CLI `migrate` подплагин: detect+install deps.
| **Perf-метрики** | CPU/RAM профилируются, FPS – только synthetic (нет in-game измерений). | Интеграция с GameHook + внутриигровой overlay.
| **Security** | Нет песочницы для Lua-скриптов, анти-чит выключен. | Включить AntiCheatValidator + Lua sandbox в v0.3.

## Известные проблемы

*   При массовом вызове `TriggerServerEvent` возможна потеря порядка сообщений.  
*   `get_player_name` возвращает `"<unknown>"` для офлайн игроков (stub).  
*   Горячая перезагрузка ресурса может пропустить повторную регистрацию события – обход: перезапуск сервера.

## Обратная связь

Пожалуйста, сообщайте о багах в канал **#fcl-feedback** (Discord) или создавайте issue в репозитории `gameverse-framework` с префиксом `[FCL]`. 