# Скрипты для настройки системы логирования

В этой директории содержатся скрипты для настройки и управления системой логирования GameVerse Framework.

## Настройка ElasticSearch

Скрипт `setup_elasticsearch.sh` создает необходимые индексы, маппинги и политики управления жизненным циклом в ElasticSearch:

```bash
# Запустите ElasticSearch и Kibana через Docker Compose
cd ../
docker-compose up -d

# После запуска контейнеров запустите скрипт настройки
cd scripts
chmod +x setup_elasticsearch.sh
./setup_elasticsearch.sh
```

Скрипт выполняет следующие действия:
1. Создает шаблон индекса `gameverse_logs` с маппингом полей
2. Настраивает политику управления жизненным циклом индексов
3. Создает начальный индекс `gameverse-logs-000001`

## Структура индекса

Индекс логов имеет следующую структуру:

- **timestamp** (date) - временная метка лога
- **level** (keyword) - уровень логирования (INFO, WARN, ERROR и т.д.)
- **service** (keyword) - имя сервиса
- **component** (keyword) - компонент внутри сервиса
- **message** (text) - сообщение лога
- **context** (object) - контекстная информация:
  - **request_id** (keyword) - идентификатор запроса
  - **user_id** (keyword) - идентификатор пользователя
  - **entity_id** (keyword) - идентификатор сущности
  - **additional_data** (object) - дополнительные данные
- **metrics** (object) - метрики:
  - **duration_ms** (long) - продолжительность операции
  - **memory_usage** (long) - использование памяти

## Управление жизненным циклом

Настроена следующая политика управления жизненным циклом индексов:

1. **Hot** (активная фаза) - новые индексы, активная запись
   - Rollover каждый день или при достижении размера 5GB
2. **Warm** (теплая фаза) - после 3 дней
   - Сжатие до 1 шарда и оптимизация
3. **Cold** (холодная фаза) - после 30 дней
   - Снижение приоритета
4. **Delete** (удаление) - после 90 дней
   - Автоматическое удаление данных 